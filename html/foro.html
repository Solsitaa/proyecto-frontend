<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Foro - Mente Libre</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <nav>
        <div class="logoNav">
            <a href="index.html">
                <img src="img/logo.png" class="logo" alt="Logo">
            </a>
            <h1>Mente Libre</h1>
        </div>
        <input type="search" placeholder="🔍 Buscar Posts" style="max-width: 400px;">
        <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
            <a href="index.html">Inicio</a>
            <a href="perfil.html" id="perfilLink" style="display: none;">Perfil</a>
            <button id="authButton" onclick="handleAuth()">Iniciar sesión</button>
        </div>
    </nav>

    <div class="contenedor-foro">
        <div class="post-list-container">
            <div id="createPostSection" style="margin-bottom: 30px; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
                 <h2>Crear Nueva Publicación</h2>
                 <div id="error-message-post" class="error-message" style="display: none;"></div>
                 <div id="success-message-post" class="success-message" style="display: none;"></div>
                 <form id="newPostForm">
                     <div class="grupo">
                         <label for="newPostContent">Tu mensaje:</label>
                         <textarea id="newPostContent" name="content" rows="4" placeholder="Comparte tus pensamientos aquí..." required maxlength="250"></textarea>
                         <small>Máximo 250 caracteres.</small>
                     </div>
                     <button type="submit" class="btn-primary">Publicar</button>
                 </form>
            </div>

            <div class="post-list" id="postList">
                 <p>Cargando posts...</p>
            </div>
        </div>

        <aside class="destacados">
            <h2>Usuarios Destacados</h2>
            <ul>
                <li>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 2rem;">👤</span>
                        <div>
                            <strong>Usuario 1</strong>
                            <p style="font-size: 0.85rem; color: #666; margin: 0;">120 reconocimientos</p>
                        </div>
                    </div>
                </li>
                 <li>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 2rem;">👤</span>
                        <div>
                            <strong>Usuario 2</strong>
                            <p style="font-size: 0.85rem; color: #666; margin: 0;">95 reconocimientos</p>
                        </div>
                    </div>
                </li>
            </ul>
        </aside>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/foro.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const createPostSection = document.getElementById('createPostSection');
            const userData = getUserData();
            if (createPostSection) {
                if (userData) {
                    createPostSection.style.display = 'block';
                } else {
                    createPostSection.style.display = 'none';
                }
            }

            const postErrorDiv = document.getElementById('error-message-post');
            const postSuccessDiv = document.getElementById('success-message-post');

            if(postErrorDiv) {
                 window.showErrorPost = function(message) {
                    postErrorDiv.textContent = message || 'Error al crear post.';
                    postErrorDiv.style.display = 'block';
                    setTimeout(() => { postErrorDiv.style.display = 'none'; }, 5000);
                 }
                 const postForm = document.getElementById('newPostForm');
                 if(postForm) {
                    
                    postForm.addEventListener('submit', (e) => {
                         window.originalShowError = window.showError;
                         window.showError = window.showErrorPost;
                        
                         handleCrearPost(e).finally(() => {
                             window.showError = window.originalShowError;
                         });
                    });
                 }
            }
             if(postSuccessDiv) {
                 window.showSuccessPost = function(message) {
                     postSuccessDiv.textContent = message || 'Post creado.';
                     postSuccessDiv.style.display = 'block';
                     setTimeout(() => { postSuccessDiv.style.display = 'none'; }, 3000);
                 }
                  const postForm = document.getElementById('newPostForm');
                  if(postForm) {
                    
                     postForm.addEventListener('submit', (e) => {
                          window.originalShowSuccess = window.showSuccess;
                          window.showSuccess = window.showSuccessPost;
                          handleCrearPost(e).finally(() => {
                              window.showSuccess = window.originalShowSuccess;
                          });
                     });
                  }
             }
        });
    </script>
</body>
</html>